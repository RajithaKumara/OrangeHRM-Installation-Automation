sudo: required
dist: trusty

language: java

jdk:
  - oraclejdk8
  - openjdk8

addons:
  chrome: stable

env:
  global:
    - GIT_APP_BRANCH=master
    - GIT_DEPTH=50
    - GIT_APP_URL=https://github.com/orangehrm/orangehrm
    - APP_DIR=orangehrm
    - GIT_ENV_BRANCH=master
    - GIT_ENV_DEPTH=50
    - GIT_ENV_URL=https://github.com/orangehrm/orangehrm-os-dev-environment
    - ENV_DIR=ohrm-os-dev-environment

services:
  - docker

cache:
  directories:
    - "$APP_DIR/symfony/lib/vendor"
    #- "target"

before_install:
  - sudo chmod 777 -R build
  - ./build/travis/before_install.sh

install:
  - ./build/travis/install.sh

before_script:
  - ./build/travis/before_script.sh

script:
  - ./build/travis/script.sh

after_failure:
  - ./build/travis/after_failure.sh

after_success:
  - ./build/travis/after_success.sh

after_script:
  - ./build/travis/after_script.sh

deploy:
  provider: s3
  access_key_id: $AWS_ACCESS_KEY
  secret_access_key: $AWS_SECRET_KEY
  bucket: $S3_Bucket
  skip_cleanup: true
  local_dir: build/dist
